<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>NEMO CLAN | HOME</title>

    <!-- Site Setting -->
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name=theme-color" content="#37474f">

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
          integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">

    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
            integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
            crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
            integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
            crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"
            integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
            crossorigin="anonymous"></script>

    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css"
          integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">

    <link href="https://fonts.googleapis.com/css?family=Nanum+Gothic" rel="stylesheet">

    <link rel="stylesheet" href="/assets/main.css">
    <script src="/assets/main.js"></script>

    <style>
        html, body {
            height: 100%;
            color: white;
        }

        html::before {
            content: ' ';
            display: block;
            background-image: url('/images/background.png');
            background-position: center;
            background-size: cover;
            height: 100vh;
            width: 100vw;
            top: 0;
            bottom: 0;
            left: 0;
            right: 0;
            position: fixed;
            z-index: -10;
        }
    </style>

</head>
<body>
<nav class="navbar navbar-light navbar-expand-lg" id="navbar"
     style="z-index: 10000; position: fixed; width: 100%; background-color: rgba(252, 252, 252, 1); border-bottom: 1px solid #ccc">
    <div class="container">
        <a class="navbar-brand" href="#">NEMO CLAN</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavDropdown"
                aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Open menu to toggle">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNavDropdown">
            <ul class="navbar-nav mr-auto mt-2 mt-lg-0">
                <li class="nav-item">
                    <a class="nav-link" href="">클랜 가입</a>
                </li>
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="/info/" id="navbar-dropdown" role="button"
                       data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        클랜 정보
                    </a>
                    <div class="dropdown-menu" aria-labelledby="navbar-dropdown">
                        <a class="dropdown-item" href="/war/">클랜전 진행 정보</a>
                        <a class="dropdown-item" href="/warlog/">클랜전 기록</a>
                        <a class="dropdown-item" onclick="updateClickedButton_menu(document.getElementById('menu_2'));">멤버 목록 및 지원량</a>
                    </div>
                </li>
            </ul>
        </div>
    </div>
</nav>

<div id="nav-space"></div>

<script>
    $(document).ready(() => {
        document.getElementById("nav-space").style.paddingTop = document.getElementById("navbar").offsetHeight + "px";
    });
</script>

<div class="container">
    <h1 style="padding-top: 50px; padding-bottom: 10px; border-bottom: 1px solid white; margin-bottom: 20px; font-size: 3em;">
        NEMO</h1>
    <br>
    <!--<button class="ghost-button" onclick="location.replace(getURL('/info/'));">클랜 정보</button>-->
    <p>NEMO 클랜 공식 홈페이지에 오신 것을 환영합니다!</p>

    <div class="menu-bar" style="margin-top: 50px;">
        <div class="list" id="menuList">
            <a class="active" onclick="updateClickedButton_menu(this)" id="menu_1"><p>클랜 소개</p></a>
            <a onclick="updateClickedButton_menu(this)" id="menu_2"><p>클랜 정보</p></a>
            <a onclick="updateClickedButton_menu(this)" id="menu_3"><p>클랜전</p></a>
        </div>
        <div class="menu">
            <a href="https://github.com/nnnlog/"><i class="fab fa-github"></i></a>
        </div>
    </div>

    <section class="info-section" id="articleList">
        <article class="article" id="article_1">
            <h6 style="font-size: 95%; font-weight: bold;">클랜 소개</h6>
            <hr color="white">
            이 클랜은 대표 CLASH님에 의해 2017년 1월 11일에 개설되었습니다.
            <br><br>
            <ul>
                <li>클랜 개설 : 2017년 1월 11일</li>
                <li>첫 클랜상자 10단계 : 2017년 1월 30일 쯤</li>
                <li>첫 주간지원 20000 달성 : 2017년 10월 1일</li>
                <li>5번째 클랜전 종료 후 지역순위 14등 달성</li>
            </ul>
        </article>
        <article class="article" id="article_2">
        <h6 style="font-size: 95%; font-weight: bold;">클랜 정보</h6>
        <hr color="white">
            <% 
            process.env.TZ = "Asia/Seoul";
            let warScore = "[알 수 없음]";
            
            let lastWar = warlog[0];
            let my_clan = null;
            let last_war_rank = 0;
            for (let clan of lastWar['standings']) {
                ++last_war_rank;
                if (clan['tag'] === clan_info['tag']) {
                    my_clan = clan;
                    break;
                }
            }

            if (my_clan !== null) {
                warScore = my_clan['warTrophies'];
            }
            %>
            <table class="table border table-hover" style="font-weight: bold; margin-top: 40px;"> 
                <thead>
                    <tr>
                    <th scope="col">분류</th>
                    <th scope="col">값</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                    <th scope="row">클랜 태그</th>
                    <td><%- clan_info['tag'] %></td>
                    </tr>
                    <tr>
                    <th scope="row">클랜 명</th>
                    <td><%- clan_info['name'] %></td>
                    </tr>
                    <tr>
                    <th scope="row">클랜 점수</th>
                    <td><%- clan_info['score'] %></td>
                    </tr>
                    <tr>
                    <th scope="row">전쟁 트로피</th>
                    <td><%- warScore %></td>
                    </tr>
                    <tr>
                    <th scope="row">클랜 멤버수</th>
                    <td><%- clan_info['memberCount'] %> / 50</td>
                    </tr>
                    <tr>
                    <th scope="row">트로피 제한</th>
                    <td><%- clan_info['requiredScore'] %></td>
                    </tr>
                    <tr>
                    <th scope="row">지원량</th>
                    <td><%- clan_info['donations'] %></td>
                    </tr>
                    <tr>
                    <th scope="row">가입 유형</th>
                    <td><%- clan_info['type'] === "invite only" ? "초대 한정" : (clan_info['type'] === "closed" ? "비공개" : "공개"); %></td>
                    </tr>
                </tbody>
            </table>
            
            <h6 style="font-size: 95%; font-weight: bold; margin-top: 80px;">멤버 목록</h6>
            <hr color="white">
            <table class="table border table-hover" style="font-weight: bold; margin-top: 40px;"> 
                <thead>
                    <tr>
                    <th style="vertical-align: inherit;" scope="col">이름</th>
                    <th style="vertical-align: inherit;" scope="col">지원량</th>
                    <th style="vertical-align: inherit;" scope="col">지원 받은 양</th>
                    </tr>
                </thead>
                <tbody>
                    <%
                    let result = "";
                    for (let player of clan_info['members']) {
                        result +=
                        "<tr><th scope='row'>" + player['name'] + "<br>(" + (player['role'] === "leader" ? "대표" : (player['role'] === "coLeader" ? "공동 대표" : (player['role'] === "elder" ? "장로" : "멤버"))) +  ")</th>" +
                        "<th style='vertical-align: inherit;'>" + player['donations'] + "</th>" +
                        "<th style='vertical-align: inherit;'>" + player['donationsReceived'] + "</th>";
                    }
                    %>
                    <%- result %>
                </tbody>
            </table>

    
        </article>
        <article class="article" id="article_3">
            <h6 style="font-size: 95%; font-weight: bold;">클랜전 현황</h6>
            <hr color="white">
            <%console.log('ddd');
            let display = "none", participants = "", extraData = "";
            result = "";
            if (clan_war['state'] === "notInWar") {
                result = "<i>전쟁이 시작되지 않았습니다.</i>";
                return;
            }

            for (let player of clan_war['participants']) {
                participants += "<tr><th scope='row'>" + player['name'] + "</th>";
                participants += "<td>" + player['cardsEarned'] + "</td>";
                participants += "<td>" + player['wins'] + '/' + player['battlesPlayed'] + "</td></tr>";
            }

            if (clan_war['state'] === "warDay") {
                extraData += "<tr><th scope='row'>현재 순위</th><td>" + last_war_rank + "등</td></tr>"
            }
            
            display = "";
            %>

            <%- result %>

            <table class="table border table-hover" style="font-weight: bold; margin-top: 40px; display: <%- display %>;">
                <tbody>
                <tr>
                    <th scope="row"><%- clan_war['state'] === "collectionDay" ? "수집일" : "전쟁일" %> 종료 시간</th>
                    <td><%- (new Date((clan_war['collectionEndTime'] || clan_war['warEndTime']) * 1000)).toLocaleString(); %></td>
                </tr>
                <%- extraData %>
                </tbody>
            </table>

            <h6 style="font-size: 95%; font-weight: bold; margin-top: 40px; display: <%- display %>;">참가자 목록</h6>
            <hr color="white">

            <table class="table border table-hover" style="font-weight: bold; margin-top: 40px; display: <%- display %>;">
                <tbody>
                <tr>
                    <th scope="row">이름</th>
                    <td>카드 수</td>
                    <td>플레이 수</td>
                </tr>
                <%- participants %>
                <tr>
                    <td colspan="3" style="text-align: center;">플레이 수 : [이긴 수]/[플레이 수]</td>
                </tr>
                </tbody>
            </table>
        </article>
    </section>

    <!-- Copyright -->
    <div style="padding-top: 600px;"></div>
    <div style="text-align: center; font-weight: bold; font-size: 80%;">
        &copy; 2017-2018 NLOG (엔로그)
    </div>
    <hr style="width: 100%;" color="white">
    <div style="padding-bottom: 10px; text-align: center; font-size: 80%;">
        이 사이트는 Supercell의 추천, 후원, 승인을 받은 콘텐츠가 아니며 Supercell은 이에 대해 책임을 지지 않습니다.
        자세한 내용은 <a href="https://supercell.com/en/fan-content-policy/">Supercell 팬 콘텐츠 정책</a>을 참조하십시오.
    </div>
</div>

</body>
</html>
